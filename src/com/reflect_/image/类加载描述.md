




## 类加载
### 1 加载阶段
1. JVM在该阶段的主要目的是将字节码从不同的数据源（可能是class文件 、可能是jar包、甚至网络）转化为**<font color="red">二进制字节流加载到内存中</font>，并生成一个代表该类的java.lang.Class对象。
### 2 连接阶段
 2.1 验证

    1. 目的是为了确保Class文件的字节流中包含的信息符合当前虚拟机的要求，并不会危害虚拟机自身的安全.
    2. 包括：文件格式验证（是否以魔数oxcafebabe开头）、元数据验证、字节码验证和符号引用验证。  
    3. 可以考虑使用 -Xverify:none 参数来关闭大部分的类验证措施，缩短虚拟机类加载的时间。
2.2 准备

    1. jvm会在该阶段对静态变量，分配内存并默认初始化（0，null,"",0L,false）

2.3 解析

    1. 虚拟机将常量池内的符号引用替换成直接引用的过程。

### 3 初始化阶段

    1. 到初始化阶段，才真正开始执行类中定义的java程序，次阶段是执行<clinit>()方法的成功。  
    2. <clinit>()方法是由编译器按语句在源文件中出现的顺序，依次自动收集类中的所有**静态变量**的赋值动作和静态代码块中的语句，并进行合并。
    3. 虚拟机会保证一个类<clinit>()方法在多线程环境中被正确地枷锁，同步，如果多个线程同事去初始化一个类，那么只会有一个线程去执行这个类的<clinit>()方法，其他线程都需要阻塞等待，知道活动线程执行<clinit>()方法完毕


